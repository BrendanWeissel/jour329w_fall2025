<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CNS Tags Browser</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
			<div class="search-row" style="display:flex;align-items:center;gap:0.05em;justify-content:center;flex-wrap:wrap;">
					<header class="main-header" style="flex:1 1 100%;text-align:center;">
							<h1>CNS Tag Browser</h1>
						</header>
						<div style="width:100%;text-align:center;margin:0.5em 0 1.2em 0;font-size:1.1em;color:#ffe6b3;">
							<strong>How to use:</strong> <br>
							Use the <b>search bar</b> to find tags by keyword. Use the <b>category dropdown</b> to filter tags by topic. Click any tag to view related Capital News Service stories.
						</div>
				<input type="text" id="search" placeholder="Search tags..." style="font-size:1.1em;padding:0.4em 1em;border-radius:1em;border:none;background:#222;color:#ffb347;" />
				<select id="categoryFilter" style="font-size:1.1em;padding:0.4em 1em;border-radius:1em;border:none;background:#222;color:#ffb347;margin-left:-0.3em;">
					<option value="all">All</option>
				</select>
			</div>
		<ul id="tagsList"></ul>
		<div class="catchline" style="text-align:center;font-size:1.5em;color:#ffb347;margin:2em 0 1em 0;letter-spacing:0.03em;font-weight:bold;text-shadow:0 2px 8px #000a;">Explore Maryland news, topics, and trends with Capital News Service</div>
		<div id="storiesSection" style="margin-top:2em;"></div>
			<script>
			// --- Category definitions ---
			const categoryDefs = [
				{ name: 'Politics', keywords: ['politic', 'election', 'senate', 'congress', 'governor', 'legislature', 'law', 'bill', 'campaign', 'vote'] },
				{ name: 'Cities', keywords: ['baltimore', 'annapolis', 'rockville', 'city', 'town', 'village'] },
				{ name: 'Counties', keywords: ['county', 'montgomery', 'prince george', 'howard', 'anne arundel', 'frederick', 'carroll', 'harford', 'charles', 'calvert'] },
				{ name: 'Education', keywords: ['school', 'college', 'university', 'education', 'student', 'teacher', 'classroom'] },
				{ name: 'Health', keywords: ['health', 'hospital', 'doctor', 'nurse', 'covid', 'vaccine', 'mental', 'medical'] },
				{ name: 'Crime & Justice', keywords: ['crime', 'police', 'court', 'judge', 'prison', 'jail', 'justice', 'law enforcement'] },
				{ name: 'Environment', keywords: ['environment', 'climate', 'water', 'bay', 'river', 'forest', 'wildlife', 'nature'] },
				{ name: 'Transportation', keywords: ['transport', 'bus', 'train', 'metro', 'road', 'highway', 'traffic', 'transit'] },
				{ name: 'Business', keywords: ['business', 'company', 'industry', 'commerce', 'startup', 'market', 'trade'] },
				{ name: 'Sports', keywords: ['sport', 'team', 'game', 'athlete', 'coach', 'league', 'tournament'] },
				{ name: 'Arts & Culture', keywords: ['art', 'music', 'theater', 'film', 'museum', 'culture', 'festival'] },
				{ name: 'Government', keywords: ['government', 'agency', 'public', 'official', 'mayor', 'council'] },
				{ name: 'People', keywords: ['person', 'people', 'profile', 'biography', 'student', 'teacher'] },
				{ name: 'Science & Tech', keywords: ['science', 'tech', 'technology', 'research', 'innovation', 'data', 'computer'] },
				{ name: 'Housing', keywords: ['housing', 'home', 'apartment', 'real estate', 'rent', 'tenant'] },
				{ name: 'Food', keywords: ['food', 'restaurant', 'bar', 'cafe', 'grocery', 'market'] },
				{ name: 'Religion', keywords: ['religion', 'church', 'faith', 'mosque', 'temple', 'synagogue'] },
				{ name: 'Military', keywords: ['military', 'army', 'navy', 'air force', 'marine', 'veteran'] },
				{ name: 'Immigration', keywords: ['immigration', 'immigrant', 'refugee', 'asylum'] },
				{ name: 'Other', keywords: [] }
			];

			// Populate dropdown
			const catSel = document.getElementById('categoryFilter');
			catSel.innerHTML = '<option value="all">All</option>' + categoryDefs.map(c => `<option value="${c.name}">${c.name}</option>`).join('');

			// Fetch tags.json and render
			fetch("../../../data/tags.json")
				.then(res => res.json())
				.then(data => {
					window.tags = data;
					renderTags();
				});

			function renderTags() {
				const search = document.getElementById('search').value.toLowerCase();
				const category = document.getElementById('categoryFilter').value;
				const tagsList = document.getElementById('tagsList');
				tagsList.innerHTML = '';
				let filtered = window.tags.filter(tag =>
					tag.name && tag.count !== 0 && tag.name.toLowerCase().includes(search)
				);
				if (category !== 'all') {
					const catObj = categoryDefs.find(c => c.name === category);
					if (catObj) {
						filtered = filtered.filter(tag => catObj.keywords.some(kw => tag.name.toLowerCase().includes(kw)));
					}
				}
				const topTags = filtered.sort((a, b) => b.count - a.count).slice(0, 20);
				for (const tag of topTags) {
					const li = document.createElement('li');
					li.style.margin = '1.2rem 0';
					li.style.textAlign = 'center';
					li.style.listStyle = 'none';
					const a = document.createElement('a');
					let displayName = tag.name;
					if (displayName.startsWith('#')) displayName = displayName.slice(1).trim();
					displayName = displayName.replace(/([a-z])([A-Z])/g, '$1 $2');
					displayName = displayName.replace(/\b\w/g, c => c.toUpperCase());
					a.textContent = displayName;
					a.href = tag.link;
					a.target = '_blank';
					a.className = 'tag-pill';
					li.appendChild(a);
					tagsList.appendChild(li);
				}
			}

			document.getElementById('search').addEventListener('input', renderTags);
			document.getElementById('categoryFilter').addEventListener('change', renderTags);
			</script>
		</script>
		<!-- Removed extraneous code -->
</body>
</html>
